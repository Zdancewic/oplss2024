<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="common/css/sf.css" rel="stylesheet" type="text/css" />
<title>Hoare3</title>
<link href="common/jquery-ui/jquery-ui.css" rel="stylesheet">
<script src="common/jquery-ui/external/jquery/jquery.js"></script>
<script src="common/jquery-ui/jquery-ui.js"></script>
<script src="common/toggleproofs.js"></script>
<link href="common/css/rip.css" rel="stylesheet" type="text/css"/>
</head>

<body>

<div id="page">

<div id="header">
<div id='logoinheader'><a href='https://softwarefoundations.cis.upenn.edu'>
<img src='common/media/image/sf_logo_sm.png' alt='Software Foundations Logo'></a></div>
<div class='booktitleinheader'><a href='index.html'>Volume 7: Reasoning about Interactive Programs</a></div>
<ul id='menu'>
   <li class='section_name'><a href='toc.html'>Table of Contents</a></li>
   <li class='section_name'><a href='coqindex.html'>Index</a></li>
</ul>
</div>

<div id="main">

<h1 class="libtitle">Hoare3</h1>


<div class="doc">
<a id="lab242"></a><h3 class="section">Reasoning About Imp programs</h3>

<div class="paragraph"> </div>

 We saw that we can use the equational theory of the monad laws, along with
  some monad-specific properties to prove program transformations.

<div class="paragraph"> </div>

  What if we want to prove other things about our programs?

</div>

<div class="doc">
<a id="lab243"></a><h3 class="section">Generalizing <span class="inlinecode"><span class="id" title="var">EqM</span></span></h3>

<div class="paragraph"> </div>

 Recall  <span class="inlinecode"><span class="id" title="var">eqM</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="keyword">∀</span></span> <span class="inlinecode"><span class="id" title="var">A</span>,</span> <span class="inlinecode"><span class="id" title="var">M</span></span> <span class="inlinecode"><span class="id" title="var">A</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">M</span></span> <span class="inlinecode"><span class="id" title="var">A</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="keyword">Prop</span></span> , in particular our insistance
   that bind be <span class="inlinecode"><span class="id" title="var">Proper</span></span>.
  
<div class="paragraph"> </div>

 Idea: generalize to a binary, heterogeneous relation:
      <span class="inlinecode"><span class="id" title="var">eqMR</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="keyword">∀</span></span> <span class="inlinecode"><span class="id" title="var">A</span></span> <span class="inlinecode"><span class="id" title="var">B</span>,</span> <span class="inlinecode"><span class="id" title="var">M</span></span> <span class="inlinecode"><span class="id" title="var">A</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">M</span></span> <span class="inlinecode"><span class="id" title="var">B</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="keyword">Prop</span></span>
  
<div class="paragraph"> </div>

<a id="lab244"></a><h3 class="section">More General Typeclass of "Related" Computations</h3>

<div class="paragraph"> </div>

<br/>
<span class="inlinecode"><span class="id" title="keyword">Definition</span> <span class="id" title="var">relH</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> := <span class="id" title="var">A</span> → <span class="id" title="var">B</span> → <span class="id" title="keyword">Prop</span>
</span>
</div>
<div class="code">

<span class="id" title="keyword">Class</span> <a id="EqMR" class="idref" href="#EqMR"><span class="id" title="record">EqMR</span></a> (<a id="M:1" class="idref" href="#M:1"><span class="id" title="binder">M</span></a> : <span class="id" title="keyword">Type</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=  {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="eqMR" class="idref" href="#eqMR"><span class="id" title="projection">eqMR</span></a> : <span class="id" title="keyword">∀</span> {<a id="A:3" class="idref" href="#A:3"><span class="id" title="binder">A</span></a> <a id="B:4" class="idref" href="#B:4"><span class="id" title="binder">B</span></a> : <span class="id" title="keyword">Type</span>} (<a id="R:5" class="idref" href="#R:5"><span class="id" title="binder">R</span></a> : <span class="id" title="definition">relationH</span> <a class="idref" href="Hoare3.html#A:3"><span class="id" title="variable">A</span></a> <a class="idref" href="Hoare3.html#B:4"><span class="id" title="variable">B</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">relationH</span> (<a class="idref" href="Hoare3.html#M:1"><span class="id" title="variable">M</span></a> <a class="idref" href="Hoare3.html#A:3"><span class="id" title="variable">A</span></a>) (<a class="idref" href="Hoare3.html#M:1"><span class="id" title="variable">M</span></a> <a class="idref" href="Hoare3.html#B:4"><span class="id" title="variable">B</span></a>)<br/>
}.<br/><hr class='doublespaceincode'/>
</div>

<div class="doc">
Assuming <span class="inlinecode"><span class="id" title="var">R</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">relationH</span></span> <span class="inlinecode"><span class="id" title="var">A</span></span> <span class="inlinecode"><span class="id" title="var">B</span></span> 
</div>
<div class="code">

<span class="id" title="keyword">Notation</span> <a id="3f0c94acfe04426056fe6b3701f613a<sub>2</sub>" class="idref" href="#3f0c94acfe04426056fe6b3701f613a<sub>2</sub>"><span class="id" title="notation">&quot;</span></a>t<sub>1</sub> ≈[ R ] t<sub>2</sub>" := (<span class="id" title="definition">eutt</span> <span class="id" title="var">R</span> <span class="id" title="var">t<sub>1</sub></span> <span class="id" title="var">t<sub>2</sub></span>)<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">eutt</span></span> <span class="inlinecode"><span class="id" title="var">R</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span> is weak bisimulation of trees whose leaves (i.e. the return nodes)
   are related by <span class="inlinecode"><span class="id" title="var">R</span></span>.

<div class="paragraph"> </div>

 
</div>
<div class="code">

<span class="id" title="keyword">Example</span> <a id="eutt_trees" class="idref" href="#eutt_trees"><span class="id" title="definition">eutt_trees</span></a> : <a class="idref" href="Hoare3.html#3f0c94acfe04426056fe6b3701f613a<sub>2</sub>"><span class="id" title="notation">(</span></a><span class="id" title="abbreviation">Vis</span> (<a class="idref" href="ImpDenotation.html#Read"><span class="id" title="constructor">Read</span></a> "X") (<span class="id" title="keyword">fun</span> <a id="n:7" class="idref" href="#n:7"><span class="id" title="binder">n</span></a> ⇒ <span class="id" title="abbreviation">Ret</span> <a class="idref" href="Hoare3.html#n:7"><span class="id" title="variable">n</span></a>)<a class="idref" href="Hoare3.html#3f0c94acfe04426056fe6b3701f613a<sub>2</sub>"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Hoare3.html#3f0c94acfe04426056fe6b3701f613a<sub>2</sub>"><span class="id" title="notation">≈[</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#lt"><span class="id" title="definition">lt</span></a> <a class="idref" href="Hoare3.html#3f0c94acfe04426056fe6b3701f613a<sub>2</sub>"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Hoare3.html#3f0c94acfe04426056fe6b3701f613a<sub>2</sub>"><span class="id" title="notation">(</span></a><span class="id" title="abbreviation">Vis</span> (<a class="idref" href="ImpDenotation.html#Read"><span class="id" title="constructor">Read</span></a> "X") (<span class="id" title="keyword">fun</span> <a id="n:8" class="idref" href="#n:8"><span class="id" title="binder">n</span></a> ⇒ <span class="id" title="abbreviation">Ret</span> (1 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Nat.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="Hoare3.html#n:8"><span class="id" title="variable">n</span></a>))<a class="idref" href="Hoare3.html#3f0c94acfe04426056fe6b3701f613a<sub>2</sub>"><span class="id" title="notation">)</span></a>.<br/>
<div class="togglescript" id="proofcontrol1" onclick="toggleDisplay('proof1');toggleDisplay('proofcontrol1')"><span class="show"></span></div>
<div class="proofscript" id="proof1" onclick="toggleDisplay('proof1');toggleDisplay('proofcontrol1')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">eqit_Vis</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">eqit_Ret</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
Note: we can <i>recover</i> the ordinary <span class="inlinecode"><span class="id" title="var">eqM</span></span> by instantiating <span class="inlinecode"><span class="id" title="var">R</span></span> with <span class="inlinecode"><span class="id" title="var">eq</span></span>. 
<div class="paragraph"> </div>

<a id="lab245"></a><h3 class="section">Intuition: <span class="inlinecode"><span class="id" title="var">eqMR</span></span></h3>

<div class="paragraph"> </div>

 The <span class="inlinecode"><span class="id" title="var">R</span></span> parameter lets us specify a kind of "postcondition" that
    lets is an assertion about the values returned by the computation.

<div class="paragraph"> </div>

    In particular, if a tree is related to <i>itself</i> with a given <span class="inlinecode"><span class="id" title="var">R</span></span>, i.e.:
<br/>
<span class="inlinecode">&nbsp;&nbsp;<span class="id" title="var">t</span> ≈[<span class="id" title="var">R</span>] <span class="id" title="var">t</span>
</span>    then we can think of the <i>diagonal</i> of <span class="inlinecode"><span class="id" title="var">R</span></span> as a predicate on the
    returned values.
 
<div class="paragraph"> </div>

<a id="lab246"></a><h3 class="section">Logical relation for (itree) <span class="inlinecode"><span class="id" title="var">ret</span></span></h3>

</div>

<div class="doc">
For <span class="inlinecode"><span class="id" title="var">eqM</span></span>, we didn't have to justify that <span class="inlinecode"><span class="id" title="var">ret</span></span> was <span class="inlinecode"><span class="id" title="var">Proper</span></span>. But
for this version, we have to show that it is.
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eqMR_Ret</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="keyword">∀</span> (<span class="id" title="var">E</span> : <span class="id" title="keyword">Type</span> → <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">R<sub>1</sub></span> <span class="id" title="var">R<sub>2</sub></span> : <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">RR</span> : <span class="id" title="var">relationH</span> <span class="id" title="var">R<sub>1</sub></span> <span class="id" title="var">R<sub>2</sub></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">r<sub>1</sub></span> : <span class="id" title="var">R<sub>1</sub></span>) (<span class="id" title="var">r<sub>2</sub></span> : <span class="id" title="var">R<sub>2</sub></span>),<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">RR</span> <span class="id" title="var">r<sub>1</sub></span> <span class="id" title="var">r<sub>2</sub></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;↔<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ret</span> <span class="id" title="var">r<sub>1</sub></span> ≈[<span class="id" title="var">RR</span>] <span class="id" title="var">Ret</span> <span class="id" title="var">r<sub>2</sub></span>
</span>
<div class="paragraph"> </div>

<a id="lab247"></a><h3 class="section">Logical relation for <span class="inlinecode"><span class="id" title="var">bind</span></span></h3>

</div>

<div class="doc">
The generalization of <span class="inlinecode"><span class="id" title="var">Proper</span></span> for <span class="inlinecode"><span class="id" title="var">bind</span></span> looks like this:
<br/>
<span class="inlinecode"><span class="id" title="var">eqMR_bind</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="keyword">∀</span> (<span class="id" title="var">E</span> : <span class="id" title="keyword">Type</span> → <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">R<sub>1</sub></span> <span class="id" title="var">R<sub>2</sub></span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">RR</span> : <span class="id" title="var">relationH</span> <span class="id" title="var">R<sub>1</sub></span> <span class="id" title="var">R<sub>2</sub></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">U<sub>1</sub></span> <span class="id" title="var">U<sub>2</sub></span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">UU</span> : <span class="id" title="var">relationH</span> <span class="id" title="var">U<sub>1</sub></span> <span class="id" title="var">U<sub>2</sub></span>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">t<sub>1</sub></span> : <span class="id" title="var">itree</span> <span class="id" title="var">E</span> <span class="id" title="var">U<sub>1</sub></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">t<sub>2</sub></span> : <span class="id" title="var">itree</span> <span class="id" title="var">E</span> <span class="id" title="var">U<sub>2</sub></span>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">k<sub>1</sub></span> : <span class="id" title="var">U<sub>1</sub></span> → <span class="id" title="var">itree</span> <span class="id" title="var">E</span> <span class="id" title="var">R<sub>1</sub></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">k<sub>2</sub></span> : <span class="id" title="var">U<sub>2</sub></span> → <span class="id" title="var">itree</span> <span class="id" title="var">E</span> <span class="id" title="var">R<sub>2</sub></span>),<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;logically-related&nbsp;initial&nbsp;trees&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t<sub>1</sub></span> ≈[<span class="id" title="var">UU</span>] <span class="id" title="var">t<sub>2</sub></span> →  <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;logically-related&nbsp;continuations&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> (<span class="id" title="var">u<sub>1</sub></span> : <span class="id" title="var">U<sub>1</sub></span>) (<span class="id" title="var">u<sub>2</sub></span> : <span class="id" title="var">U<sub>2</sub></span>), <span class="id" title="var">UU</span> <span class="id" title="var">u<sub>1</sub></span> <span class="id" title="var">u<sub>2</sub></span> → <span class="id" title="var">k<sub>1</sub></span> <span class="id" title="var">u<sub>1</sub></span> ≈[ <span class="id" title="var">RR</span>] <span class="id" title="var">k<sub>2</sub></span> <span class="id" title="var">u<sub>2</sub></span>) →<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;yield&nbsp;logically-related&nbsp;computations&nbsp;built&nbsp;with&nbsp;bind&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">x</span> &lt;- <span class="id" title="var">t<sub>1</sub></span>;; <span class="id" title="var">k<sub>1</sub></span> <span class="id" title="var">x</span>) ≈[<span class="id" title="var">RR</span>] (<span class="id" title="var">x</span> &lt;- <span class="id" title="var">t<sub>2</sub></span>;; <span class="id" title="var">k<sub>2</sub></span> <span class="id" title="var">x</span>)
</span>
<div class="paragraph"> </div>

<a id="lab248"></a><h3 class="section">Expected Properties Of <span class="inlinecode"><span class="id" title="var">EqMR</span></span></h3>

<div class="paragraph"> </div>

 <span class="inlinecode"><span class="id" title="var">EqMR</span></span>

<div class="paragraph"> </div>

<ul class="doclist">
<li> If <span class="inlinecode"><span class="id" title="var">R</span></span> is a an equivalence then so is <span class="inlinecode">≈[<span class="id" title="var">R</span>]</span>

<div class="paragraph"> </div>


</li>
<li> Monotonicity: if <span class="inlinecode"><span class="id" title="var">R<sub>1</sub></span></span> <span class="inlinecode">⊆</span> <span class="inlinecode"><span class="id" title="var">R<sub>2</sub></span></span> then <span class="inlinecode">≈[<span class="id" title="var">R<sub>1</sub></span>]</span> <span class="inlinecode">⊆</span> <span class="inlinecode">≈[<span class="id" title="var">R<sub>2</sub></span>]</span>

<div class="paragraph"> </div>


</li>
<li> General notion of the "image" of a monadic computation (useful for inversion principles).

</li>
</ul>

<div class="paragraph"> </div>

<br/>
<span class="inlinecode"><span class="id" title="keyword">Definition</span> <span class="id" title="var">imageH</span> <span class="id" title="var">m</span> <span class="id" title="var">a<sub>1</sub></span> <span class="id" title="var">a<sub>2</sub></span> := <span class="id" title="keyword">∀</span> <span class="id" title="var">R</span>, <span class="id" title="var">PER</span> <span class="id" title="var">R</span> → <span class="id" title="var">m</span> ≈[<span class="id" title="var">R</span>] <span class="id" title="var">m</span> → <span class="id" title="var">R</span> <span class="id" title="var">a<sub>1</sub></span> <span class="id" title="var">a<sub>2</sub></span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">image</span> <span class="id" title="var">m</span> <span class="id" title="var">a</span> := <span class="id" title="var">imageH</span> <span class="id" title="var">m</span> <span class="id" title="var">a</span> <span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Notation</span> "a ∈ m" := (<span class="id" title="var">image</span> <span class="id" title="var">m</span> <span class="id" title="var">a</span>)
</span>
<div class="paragraph"> </div>

<a id="lab249"></a><h3 class="section">Semantic Definition of Hoare Triples</h3>

<div class="paragraph"> </div>

 Predicates on the Imp memory state: 
<div class="paragraph"> </div>

<br/>
<span class="inlinecode"><span class="id" title="keyword">Definition</span> <span class="id" title="var">Assertion</span> := <span class="id" title="var">mem</span> → <span class="id" title="keyword">Prop</span>.
</span>
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="hoare_itree_triple" class="idref" href="#hoare_itree_triple"><span class="id" title="definition">hoare_itree_triple</span></a> (<a id="P:9" class="idref" href="#P:9"><span class="id" title="binder">P</span></a>:<a class="idref" href="Hoare.html#Assertion"><span class="id" title="definition">Assertion</span></a>) (<a id="c:10" class="idref" href="#c:10"><span class="id" title="binder">c</span></a>:<a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a>) (<a id="Q:11" class="idref" href="#Q:11"><span class="id" title="binder">Q</span></a>:<a class="idref" href="Hoare.html#Assertion"><span class="id" title="definition">Assertion</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="feb34c1ba9419896b17e3d09a5a7adde" class="idref" href="#feb34c1ba9419896b17e3d09a5a7adde"><span class="id" title="binder">σ</span></a>, <a class="idref" href="Hoare3.html#P:9"><span class="id" title="variable">P</span></a> <a class="idref" href="Hoare3.html#feb34c1ba9419896b17e3d09a5a7adde"><span class="id" title="variable">σ</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Hoare3.html#3f0c94acfe04426056fe6b3701f613a<sub>2</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ImpDenotation.html#7e366676838614efda76d1a99485c90a"><span class="id" title="notation">ℑ</span></a> <a class="idref" href="ImpDenotation.html#7e366676838614efda76d1a99485c90a"><span class="id" title="notation">⟦</span></a><a class="idref" href="ImpDenotation.html#7e366676838614efda76d1a99485c90a"><span class="id" title="notation">c</span></a><a class="idref" href="ImpDenotation.html#7e366676838614efda76d1a99485c90a"><span class="id" title="notation">⟧</span></a> <a class="idref" href="ImpDenotation.html#7e366676838614efda76d1a99485c90a"><span class="id" title="notation">σ</span></a><a class="idref" href="Hoare3.html#3f0c94acfe04426056fe6b3701f613a<sub>2</sub>"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Hoare3.html#3f0c94acfe04426056fe6b3701f613a<sub>2</sub>"><span class="id" title="notation">≈[(</span></a><span class="id" title="keyword">fun</span> '<a id="pat:14" class="idref" href="#pat:14"><span class="id" title="binder">(</span></a><a id="6990bcca7ad84a3c88c2494d96bfeb88" class="idref" href="#6990bcca7ad84a3c88c2494d96bfeb88"><span class="id" title="binder"><span id="pat:14" class="id">σ1</span></span></a><a id="pat:14" class="idref" href="#pat:14"><span class="id" title="binder">,</span></a><a id="pat:14" class="idref" href="#pat:14"><span class="id" title="binder">_</span></a><a id="pat:14" class="idref" href="#pat:14"><span class="id" title="binder">)</span></a> '<a id="pat:16" class="idref" href="#pat:16"><span class="id" title="binder">(</span></a><a id="6b746e1d0a997f46b300e5e0927ba8c<sub>1</sub>" class="idref" href="#6b746e1d0a997f46b300e5e0927ba8c<sub>1</sub>"><span class="id" title="binder"><span id="pat:16" class="id">σ2</span></span></a><a id="pat:16" class="idref" href="#pat:16"><span class="id" title="binder">,</span></a><a id="pat:16" class="idref" href="#pat:16"><span class="id" title="binder">_</span></a><a id="pat:16" class="idref" href="#pat:16"><span class="id" title="binder">)</span></a> ⇒ <a class="idref" href="Hoare3.html#6990bcca7ad84a3c88c2494d96bfeb88"><span class="id" title="variable">σ1</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Hoare3.html#6b746e1d0a997f46b300e5e0927ba8c<sub>1</sub>"><span class="id" title="variable">σ2</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Hoare3.html#Q:11"><span class="id" title="variable">Q</span></a> <a class="idref" href="Hoare3.html#6990bcca7ad84a3c88c2494d96bfeb88"><span class="id" title="variable">σ1</span></a><a class="idref" href="Hoare3.html#3f0c94acfe04426056fe6b3701f613a<sub>2</sub>"><span class="id" title="notation">)]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Hoare3.html#3f0c94acfe04426056fe6b3701f613a<sub>2</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ImpDenotation.html#7e366676838614efda76d1a99485c90a"><span class="id" title="notation">ℑ</span></a> <a class="idref" href="ImpDenotation.html#7e366676838614efda76d1a99485c90a"><span class="id" title="notation">⟦</span></a><a class="idref" href="ImpDenotation.html#7e366676838614efda76d1a99485c90a"><span class="id" title="notation">c</span></a><a class="idref" href="ImpDenotation.html#7e366676838614efda76d1a99485c90a"><span class="id" title="notation">⟧</span></a> <a class="idref" href="ImpDenotation.html#7e366676838614efda76d1a99485c90a"><span class="id" title="notation">σ</span></a><a class="idref" href="Hoare3.html#3f0c94acfe04426056fe6b3701f613a<sub>2</sub>"><span class="id" title="notation">)</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Notation</span> <a id="d14d6a94ef424fa020b7dfc61d76d9ee" class="idref" href="#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">&quot;</span></a>⦃ P ⦄  c  ⦃ Q ⦄" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="Hoare3.html#hoare_itree_triple"><span class="id" title="definition">hoare_itree_triple</span></a> <span class="id" title="var">P</span> <span class="id" title="var">c</span> <span class="id" title="var">Q</span>)<br/>
</div>

<div class="doc">
<a id="lab250"></a><h3 class="section">Proofs of Hoare Inference Rules</h3>

</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <a id="hoare_itree_skip" class="idref" href="#hoare_itree_skip"><span class="id" title="lemma">hoare_itree_skip</span></a> : <span class="id" title="keyword">∀</span> <a id="P:17" class="idref" href="#P:17"><span class="id" title="binder">P</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:17"><span class="id" title="variable">P</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Imp.html#:com:com_scope:'skip'"><span class="id" title="notation">skip</span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:17"><span class="id" title="variable">P</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a>.<br/>
<div class="togglescript" id="proofcontrol2" onclick="toggleDisplay('proof2');toggleDisplay('proofcontrol2')"><span class="show"></span></div>
<div class="proofscript" id="proof2" onclick="toggleDisplay('proof2');toggleDisplay('proofcontrol2')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Hoare3.html#hoare_itree_triple"><span class="id" title="definition">hoare_itree_triple</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">interp_state_ret</span>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">eutt_Ret</span>. <span class="id" title="tactic">intuition</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="hoare_itree_seq" class="idref" href="#hoare_itree_seq"><span class="id" title="lemma">hoare_itree_seq</span></a> : <span class="id" title="keyword">∀</span> <a id="P:18" class="idref" href="#P:18"><span class="id" title="binder">P</span></a> <a id="Q:19" class="idref" href="#Q:19"><span class="id" title="binder">Q</span></a> <a id="R:20" class="idref" href="#R:20"><span class="id" title="binder">R</span></a> <a id="c<sub>1</sub>:21" class="idref" href="#c<sub>1</sub>:21"><span class="id" title="binder">c<sub>1</sub></span></a> <a id="c<sub>2</sub>:22" class="idref" href="#c<sub>2</sub>:22"><span class="id" title="binder">c<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q:19"><span class="id" title="variable">Q</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#c<sub>2</sub>:22"><span class="id" title="variable">c<sub>2</sub></span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#R:20"><span class="id" title="variable">R</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:18"><span class="id" title="variable">P</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#c<sub>1</sub>:21"><span class="id" title="variable">c<sub>1</sub></span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q:19"><span class="id" title="variable">Q</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:18"><span class="id" title="variable">P</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#c<sub>1</sub>:21"><span class="id" title="variable">c<sub>1</sub></span></a><a class="idref" href="Imp.html#313afe74ec81f2da17d8e7bca3b042e<sub>7</sub>"><span class="id" title="notation">;</span></a> <a class="idref" href="Hoare3.html#c<sub>2</sub>:22"><span class="id" title="variable">c<sub>2</sub></span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#R:20"><span class="id" title="variable">R</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a>.<br/>
<div class="togglescript" id="proofcontrol3" onclick="toggleDisplay('proof3');toggleDisplay('proofcontrol3')"><span class="show"></span></div>
<div class="proofscript" id="proof3" onclick="toggleDisplay('proof3');toggleDisplay('proofcontrol3')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Hoare3.html#hoare_itree_triple"><span class="id" title="definition">hoare_itree_triple</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">R</span> <span class="id" title="var">c<sub>1</sub></span> <span class="id" title="var">c<sub>2</sub></span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span> <span class="id" title="var">st</span> <span class="id" title="var">PRE</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">norm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">eutt_clo_bind</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H<sub>2</sub></span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">u<sub>1</sub></span>, <span class="id" title="var">u<sub>2</sub></span>. <span class="id" title="tactic">intros</span> [<span class="id" title="var">MEQ</span> <span class="id" title="var">QM</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">H<sub>1</sub></span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
<a id="lab251"></a><h3 class="section">Hoare rules for Assignment</h3>

</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <a id="hoare_itree_asgn" class="idref" href="#hoare_itree_asgn"><span class="id" title="lemma">hoare_itree_asgn</span></a> : <span class="id" title="keyword">∀</span> <a id="Q:23" class="idref" href="#Q:23"><span class="id" title="binder">Q</span></a> <a id="X:24" class="idref" href="#X:24"><span class="id" title="binder">X</span></a> <a id="a:25" class="idref" href="#a:25"><span class="id" title="binder">a</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q:23"><span class="id" title="variable">Q</span></a> <a class="idref" href="Hoare.html#510fc37417e4aa55210e4cfe35fb96ae"><span class="id" title="notation">[</span></a><a class="idref" href="Hoare3.html#X:24"><span class="id" title="variable">X</span></a> <a class="idref" href="Hoare.html#510fc37417e4aa55210e4cfe35fb96ae"><span class="id" title="notation"><span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>&#x22A2;</span><span style='font-size:90%;'>&gt;</span></span></span></span></span></a> <a class="idref" href="Hoare3.html#a:25"><span class="id" title="variable">a</span></a><a class="idref" href="Hoare.html#510fc37417e4aa55210e4cfe35fb96ae"><span class="id" title="notation">]</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#X:24"><span class="id" title="variable">X</span></a> <a class="idref" href="Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="Hoare3.html#a:25"><span class="id" title="variable">a</span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q:23"><span class="id" title="variable">Q</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a>.<br/>
<div class="togglescript" id="proofcontrol4" onclick="toggleDisplay('proof4');toggleDisplay('proofcontrol4')"><span class="show"></span></div>
<div class="proofscript" id="proof4" onclick="toggleDisplay('proof4');toggleDisplay('proofcontrol4')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Hoare3.html#hoare_itree_triple"><span class="id" title="definition">hoare_itree_triple</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Q</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span> σ <span class="id" title="var">HQ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">norm</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">eutt_Ret</span>. <span class="id" title="tactic">intuition</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
An alternative formulation that works better for forward reasoning. 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <a id="hoare_itree_asgn'" class="idref" href="#hoare_itree_asgn'"><span class="id" title="lemma">hoare_itree_asgn'</span></a> : <span class="id" title="keyword">∀</span> <a id="P:26" class="idref" href="#P:26"><span class="id" title="binder">P</span></a> <a id="X:27" class="idref" href="#X:27"><span class="id" title="binder">X</span></a> <a id="a:28" class="idref" href="#a:28"><span class="id" title="binder">a</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:26"><span class="id" title="variable">P</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Hoare3.html#X:27"><span class="id" title="variable">X</span></a> <a class="idref" href="Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="Hoare3.html#a:28"><span class="id" title="variable">a</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a> <span class="id" title="keyword">fun</span> (<a id="41fad5ed30e0ddd6aae2f148cb138a<sub>09</sub>" class="idref" href="#41fad5ed30e0ddd6aae2f148cb138a<sub>09</sub>"><span class="id" title="binder">σ</span></a>:<a class="idref" href="ImpDenotation.html#mem"><span class="id" title="definition">mem</span></a>) ⇒ <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="28e3931d7d5dd88c96bd68216bfc47ba" class="idref" href="#28e3931d7d5dd88c96bd68216bfc47ba"><span class="id" title="binder">σ'</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="Hoare3.html#41fad5ed30e0ddd6aae2f148cb138a<sub>09</sub>"><span class="id" title="variable">σ</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="Hoare3.html#X:27"><span class="id" title="variable">X</span></a> <a class="idref" href="Maps.html#630986d105c0f1782d085b9a306379a<sub>7</sub>"><span class="id" title="notation">!<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span></span></a> <a class="idref" href="Maps.html#630986d105c0f1782d085b9a306379a<sub>7</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Hoare3.html#28e3931d7d5dd88c96bd68216bfc47ba"><span class="id" title="variable">σ'</span></a> <a class="idref" href="Hoare3.html#a:28"><span class="id" title="variable">a</span></a><a class="idref" href="Maps.html#630986d105c0f1782d085b9a306379a<sub>7</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="Maps.html#630986d105c0f1782d085b9a306379a<sub>7</sub>"><span class="id" title="notation">;</span></a> <a class="idref" href="Hoare3.html#28e3931d7d5dd88c96bd68216bfc47ba"><span class="id" title="variable">σ'</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Hoare3.html#P:26"><span class="id" title="variable">P</span></a> <a class="idref" href="Hoare3.html#28e3931d7d5dd88c96bd68216bfc47ba"><span class="id" title="variable">σ'</span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a>.<br/>
<div class="togglescript" id="proofcontrol5" onclick="toggleDisplay('proof5');toggleDisplay('proofcontrol5')"><span class="show"></span></div>
<div class="proofscript" id="proof5" onclick="toggleDisplay('proof5');toggleDisplay('proofcontrol5')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Hoare3.html#hoare_itree_triple"><span class="id" title="definition">hoare_itree_triple</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span> σ <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">norm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">eutt_Ret</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">∃</span> σ. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
<a id="lab252"></a><h3 class="section">Hoare rules for Conditionals</h3>

</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <a id="hoare_itree_if" class="idref" href="#hoare_itree_if"><span class="id" title="lemma">hoare_itree_if</span></a> : <span class="id" title="keyword">∀</span> <a id="P:31" class="idref" href="#P:31"><span class="id" title="binder">P</span></a> <a id="Q:32" class="idref" href="#Q:32"><span class="id" title="binder">Q</span></a> (<a id="b:33" class="idref" href="#b:33"><span class="id" title="binder">b</span></a>:<a class="idref" href="Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>) <a id="c<sub>1</sub>:34" class="idref" href="#c<sub>1</sub>:34"><span class="id" title="binder">c<sub>1</sub></span></a> <a id="c<sub>2</sub>:35" class="idref" href="#c<sub>2</sub>:35"><span class="id" title="binder">c<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a> <a class="idref" href="Hoare3.html#P:31"><span class="id" title="variable">P</span></a> <a class="idref" href="Hoare.html#cce4ad113420d0c25c6ce4891bbe5028"><span class="id" title="notation">∧</span></a> <a class="idref" href="Hoare3.html#b:33"><span class="id" title="variable">b</span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#c<sub>1</sub>:34"><span class="id" title="variable">c<sub>1</sub></span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q:32"><span class="id" title="variable">Q</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a> <a class="idref" href="Hoare3.html#P:31"><span class="id" title="variable">P</span></a> <a class="idref" href="Hoare.html#cce4ad113420d0c25c6ce4891bbe5028"><span class="id" title="notation">∧</span></a> <a class="idref" href="Hoare.html#90b84b70bae2a0cf52991d884e146143"><span class="id" title="notation">¬</span></a> <a class="idref" href="Hoare3.html#b:33"><span class="id" title="variable">b</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#c<sub>2</sub>:35"><span class="id" title="variable">c<sub>2</sub></span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q:32"><span class="id" title="variable">Q</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:31"><span class="id" title="variable">P</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> <a class="idref" href="Hoare3.html#b:33"><span class="id" title="variable">b</span></a> <a class="idref" href="Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a> <a class="idref" href="Hoare3.html#c<sub>1</sub>:34"><span class="id" title="variable">c<sub>1</sub></span></a> <a class="idref" href="Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a> <a class="idref" href="Hoare3.html#c<sub>2</sub>:35"><span class="id" title="variable">c<sub>2</sub></span></a> <a class="idref" href="Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q:32"><span class="id" title="variable">Q</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a>.<br/>
<div class="togglescript" id="proofcontrol6" onclick="toggleDisplay('proof6');toggleDisplay('proofcontrol6')"><span class="show"></span></div>
<div class="proofscript" id="proof6" onclick="toggleDisplay('proof6');toggleDisplay('proofcontrol6')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">b</span> <span class="id" title="var">c<sub>1</sub></span> <span class="id" title="var">c<sub>2</sub></span> <span class="id" title="var">H</span> <span class="id" title="var">H<sub>0</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Hoare3.html#hoare_itree_triple"><span class="id" title="definition">hoare_itree_triple</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> σ <span class="id" title="var">HS</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">norm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a> σ <span class="id" title="var">b</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HB</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">H<sub>0</sub></span>. <span class="id" title="tactic">intuition</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>1</sub></span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">HB</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>1</sub></span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H<sub>1</sub></span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
<a id="lab253"></a><h3 class="section">Hoare rules for While Loop</h3>

</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <a id="hoare_itree_while" class="idref" href="#hoare_itree_while"><span class="id" title="lemma">hoare_itree_while</span></a> : <span class="id" title="keyword">∀</span> <a id="P:36" class="idref" href="#P:36"><span class="id" title="binder">P</span></a> (<a id="b:37" class="idref" href="#b:37"><span class="id" title="binder">b</span></a>:<a class="idref" href="Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>) <a id="c:38" class="idref" href="#c:38"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:36"><span class="id" title="variable">P</span></a> <a class="idref" href="Hoare.html#cce4ad113420d0c25c6ce4891bbe5028"><span class="id" title="notation">∧</span></a> <a class="idref" href="Hoare3.html#b:37"><span class="id" title="variable">b</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#c:38"><span class="id" title="variable">c</span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:36"><span class="id" title="variable">P</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:36"><span class="id" title="variable">P</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="Hoare3.html#b:37"><span class="id" title="variable">b</span></a> <a class="idref" href="Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <a class="idref" href="Hoare3.html#c:38"><span class="id" title="variable">c</span></a> <a class="idref" href="Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:36"><span class="id" title="variable">P</span></a> <a class="idref" href="Hoare.html#cce4ad113420d0c25c6ce4891bbe5028"><span class="id" title="notation">∧</span></a> <a class="idref" href="Hoare.html#90b84b70bae2a0cf52991d884e146143"><span class="id" title="notation">¬</span></a> <a class="idref" href="Hoare3.html#b:37"><span class="id" title="variable">b</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a>.<br/>
<div class="togglescript" id="proofcontrol7" onclick="toggleDisplay('proof7');toggleDisplay('proofcontrol7')"><span class="show"></span></div>
<div class="proofscript" id="proof7" onclick="toggleDisplay('proof7');toggleDisplay('proofcontrol7')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Hoare3.html#hoare_itree_triple"><span class="id" title="definition">hoare_itree_triple</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">einit</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">ecofix</span> <span class="id" title="var">CIH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> σ <span class="id" title="var">HS</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Utils.html#unfold_repeat"><span class="id" title="lemma">unfold_repeat</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bind_bind</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO&nbsp;SAZ:&nbsp;<span class="inlinecode"><span class="id" title="var">norm</span></span>&nbsp;loops&nbsp;here&nbsp;for&nbsp;some&nbsp;reason.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">interp_state_bind</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">ebind</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="constructor">pbc_intro_h</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">RU</span> := <span class="id" title="keyword">fun</span> '<a id="pat:41" class="idref" href="#pat:41"><span class="id" title="binder"><span id="pat:47" class="id">(</span></span></a><a id="st<sub>1</sub>:40" class="idref" href="#st<sub>1</sub>:40"><span class="id" title="binder"><span id="pat:41" class="id"><span id="st<sub>1</sub>:46" class="id"><span id="pat:47" class="id">st<sub>1</sub></span></span></span></span></a><a id="pat:41" class="idref" href="#pat:41"><span class="id" title="binder"><span id="pat:47" class="id">,</span></span></a> <a id="b<sub>1</sub>:39" class="idref" href="#b<sub>1</sub>:39"><span class="id" title="binder"><span id="pat:41" class="id"><span id="b<sub>1</sub>:45" class="id"><span id="pat:47" class="id">b<sub>1</sub></span></span></span></span></a><a id="pat:41" class="idref" href="#pat:41"><span class="id" title="binder"><span id="pat:47" class="id">)</span></span></a> '<a id="pat:44" class="idref" href="#pat:44"><span class="id" title="binder"><span id="pat:50" class="id">(</span></span></a><a id="st<sub>2</sub>:43" class="idref" href="#st<sub>2</sub>:43"><span class="id" title="binder"><span id="pat:44" class="id"><span id="st<sub>2</sub>:49" class="id"><span id="pat:50" class="id">st<sub>2</sub></span></span></span></span></a><a id="pat:44" class="idref" href="#pat:44"><span class="id" title="binder"><span id="pat:50" class="id">,</span></span></a> <a id="b<sub>2</sub>:42" class="idref" href="#b<sub>2</sub>:42"><span class="id" title="binder"><span id="pat:44" class="id"><span id="b<sub>2</sub>:48" class="id"><span id="pat:50" class="id">b<sub>2</sub></span></span></span></span></a><a id="pat:44" class="idref" href="#pat:44"><span class="id" title="binder"><span id="pat:50" class="id">)</span></span></a> ⇒ <a class="idref" href="Hoare3.html#st<sub>1</sub>:40"><span class="id" title="variable">st<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Hoare3.html#st<sub>2</sub>:43"><span class="id" title="variable">st<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Hoare3.html#st<sub>1</sub>:40"><span class="id" title="variable">st<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> σ <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Hoare3.html#b<sub>1</sub>:39"><span class="id" title="variable">b<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Hoare3.html#b<sub>2</sub>:42"><span class="id" title="variable">b<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Hoare3.html#b<sub>1</sub>:39"><span class="id" title="variable">b<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a> σ <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">norm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">eqit_Ret</span>. <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">u<sub>1</sub></span>, <span class="id" title="var">u<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H<sub>0</sub></span> <span class="id" title="keyword">as</span> [? [? [? ?]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a> σ <span class="id" title="var">b</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HB</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">norm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Hoare3.html#hoare_itree_triple"><span class="id" title="definition">hoare_itree_triple</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span> σ (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#conj"><span class="id" title="constructor">conj</span></a> <span class="id" title="var">HS</span>  <span class="id" title="var">HB</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ebind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">u<sub>1</sub></span>, <span class="id" title="var">u<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">norm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">interp_state_tau</span>. <span class="id" title="var">estep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">norm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">estep</span>. <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">HB</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>0</sub></span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H<sub>0</sub></span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
<a id="lab254"></a><h3 class="section">Hoare rules for logical consequence</h3>

</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <a id="hoare_itree_consequence_pre" class="idref" href="#hoare_itree_consequence_pre"><span class="id" title="lemma">hoare_itree_consequence_pre</span></a> : <span class="id" title="keyword">∀</span> (<a id="P:51" class="idref" href="#P:51"><span class="id" title="binder">P</span></a> <a id="P':52" class="idref" href="#P':52"><span class="id" title="binder">P'</span></a> <a id="Q:53" class="idref" href="#Q:53"><span class="id" title="binder">Q</span></a> : <a class="idref" href="Hoare.html#Assertion"><span class="id" title="definition">Assertion</span></a>) <a id="c:54" class="idref" href="#c:54"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P':52"><span class="id" title="variable">P'</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#c:54"><span class="id" title="variable">c</span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q:53"><span class="id" title="variable">Q</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#P:51"><span class="id" title="variable">P</span></a> <a class="idref" href="Hoare.html#::hoare_spec_scope:x_'-&gt;&gt;'_x"><span class="id" title="notation"><span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span><span style='letter-spacing:-.2em;'>></span>></span></span></span></a> <a class="idref" href="Hoare3.html#P':52"><span class="id" title="variable">P'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:51"><span class="id" title="variable">P</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#c:54"><span class="id" title="variable">c</span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q:53"><span class="id" title="variable">Q</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a>.<br/>
<div class="togglescript" id="proofcontrol8" onclick="toggleDisplay('proof8');toggleDisplay('proofcontrol8')"><span class="show"></span></div>
<div class="proofscript" id="proof8" onclick="toggleDisplay('proof8');toggleDisplay('proofcontrol8')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">P'</span> <span class="id" title="var">Q</span> <span class="id" title="var">c</span> <span class="id" title="var">Htriple</span> <span class="id" title="var">Hpre</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Hoare3.html#hoare_itree_triple"><span class="id" title="definition">hoare_itree_triple</span></a> <span class="id" title="keyword">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> σ <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Htriple</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hpre</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="hoare_itree_consequence_conj" class="idref" href="#hoare_itree_consequence_conj"><span class="id" title="lemma">hoare_itree_consequence_conj</span></a> : <span class="id" title="keyword">∀</span> (<a id="P:55" class="idref" href="#P:55"><span class="id" title="binder">P</span></a> <a id="Q:56" class="idref" href="#Q:56"><span class="id" title="binder">Q</span></a> <a id="Q':57" class="idref" href="#Q':57"><span class="id" title="binder">Q'</span></a> : <a class="idref" href="Hoare.html#Assertion"><span class="id" title="definition">Assertion</span></a>) <a id="c:58" class="idref" href="#c:58"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:55"><span class="id" title="variable">P</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#c:58"><span class="id" title="variable">c</span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q:56"><span class="id" title="variable">Q</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:55"><span class="id" title="variable">P</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#c:58"><span class="id" title="variable">c</span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q':57"><span class="id" title="variable">Q'</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:55"><span class="id" title="variable">P</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#c:58"><span class="id" title="variable">c</span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q:56"><span class="id" title="variable">Q</span></a> <a class="idref" href="Hoare.html#cce4ad113420d0c25c6ce4891bbe5028"><span class="id" title="notation">∧</span></a> <a class="idref" href="Hoare3.html#Q':57"><span class="id" title="variable">Q'</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a>.<br/>
<div class="togglescript" id="proofcontrol9" onclick="toggleDisplay('proof9');toggleDisplay('proofcontrol9')"><span class="show"></span></div>
<div class="proofscript" id="proof9" onclick="toggleDisplay('proof9');toggleDisplay('proofcontrol9')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">Q'</span> <span class="id" title="var">c</span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Hoare3.html#hoare_itree_triple"><span class="id" title="definition">hoare_itree_triple</span></a> <span class="id" title="keyword">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> σ <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H<sub>1</sub></span> σ <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H<sub>2</sub></span> σ <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="lemma">eutt_conj</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">eqit_mon</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x<sub>0</sub></span>, <span class="id" title="var">x<sub>1</sub></span>. <span class="id" title="tactic">intuition</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="hoare_itree_consequence_post" class="idref" href="#hoare_itree_consequence_post"><span class="id" title="lemma">hoare_itree_consequence_post</span></a> : <span class="id" title="keyword">∀</span> (<a id="P:59" class="idref" href="#P:59"><span class="id" title="binder">P</span></a> <a id="Q:60" class="idref" href="#Q:60"><span class="id" title="binder">Q</span></a> <a id="Q':61" class="idref" href="#Q':61"><span class="id" title="binder">Q'</span></a> : <a class="idref" href="Hoare.html#Assertion"><span class="id" title="definition">Assertion</span></a>) <a id="c:62" class="idref" href="#c:62"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:59"><span class="id" title="variable">P</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#c:62"><span class="id" title="variable">c</span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q':61"><span class="id" title="variable">Q'</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#Q':61"><span class="id" title="variable">Q'</span></a> <a class="idref" href="Hoare.html#::hoare_spec_scope:x_'-&gt;&gt;'_x"><span class="id" title="notation"><span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span><span style='letter-spacing:-.2em;'>></span>></span></span></span></a> <a class="idref" href="Hoare3.html#Q:60"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:59"><span class="id" title="variable">P</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#c:62"><span class="id" title="variable">c</span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q:60"><span class="id" title="variable">Q</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a>.<br/>
<div class="togglescript" id="proofcontrol10" onclick="toggleDisplay('proof10');toggleDisplay('proofcontrol10')"><span class="show"></span></div>
<div class="proofscript" id="proof10" onclick="toggleDisplay('proof10');toggleDisplay('proofcontrol10')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">P'</span> <span class="id" title="var">Q</span> <span class="id" title="var">Q'</span> <span class="id" title="var">c</span> <span class="id" title="var">Htriple</span> <span class="id" title="var">Hpre</span> <span class="id" title="var">Hpost</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Hoare3.html#hoare_itree_triple"><span class="id" title="definition">hoare_itree_triple</span></a> <span class="id" title="keyword">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">eqit_mon</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">RR</span> := (<span class="id" title="keyword">fun</span> '<a id="pat:64" class="idref" href="#pat:64"><span class="id" title="binder"><span id="pat:68" class="id">(</span></span></a><a id="6d8c8043b104387d798bd0915e3ba81f" class="idref" href="#6d8c8043b104387d798bd0915e3ba81f"><span class="id" title="binder"><span id="pat:64" class="id"><span id="b6775737a37cc720faffa2a057a2ea<sub>99</sub>" class="id"><span id="pat:68" class="id">σ1</span></span></span></span></a><a id="pat:64" class="idref" href="#pat:64"><span class="id" title="binder"><span id="pat:68" class="id">,</span></span></a> <a id="pat:64" class="idref" href="#pat:64"><span class="id" title="binder"><span id="pat:68" class="id">_</span></span></a><a id="pat:64" class="idref" href="#pat:64"><span class="id" title="binder"><span id="pat:68" class="id">)</span></span></a> '<a id="pat:66" class="idref" href="#pat:66"><span class="id" title="binder"><span id="pat:70" class="id">(</span></span></a><a id="a4da3cb9cd3a38e0aeea02ce473f32e<sub>6</sub>" class="idref" href="#a4da3cb9cd3a38e0aeea02ce473f32e<sub>6</sub>"><span class="id" title="binder"><span id="pat:66" class="id"><span id="683353f1c3ac07d4d28d248a332782ae" class="id"><span id="pat:70" class="id">σ2</span></span></span></span></a><a id="pat:66" class="idref" href="#pat:66"><span class="id" title="binder"><span id="pat:70" class="id">,</span></span></a> <a id="pat:66" class="idref" href="#pat:66"><span class="id" title="binder"><span id="pat:70" class="id">_</span></span></a><a id="pat:66" class="idref" href="#pat:66"><span class="id" title="binder"><span id="pat:70" class="id">)</span></span></a> ⇒ <a class="idref" href="Hoare3.html#6d8c8043b104387d798bd0915e3ba81f"><span class="id" title="variable">σ1</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Hoare3.html#a4da3cb9cd3a38e0aeea02ce473f32e<sub>6</sub>"><span class="id" title="variable">σ2</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <span class="id" title="var">Q</span> <a class="idref" href="Hoare3.html#6d8c8043b104387d798bd0915e3ba81f"><span class="id" title="variable">σ1</span></a>) ); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x<sub>0</sub></span>, <span class="id" title="var">x<sub>1</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">c</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="hoare_itree_consequence" class="idref" href="#hoare_itree_consequence"><span class="id" title="lemma">hoare_itree_consequence</span></a> : <span class="id" title="keyword">∀</span> (<a id="P:71" class="idref" href="#P:71"><span class="id" title="binder">P</span></a> <a id="P':72" class="idref" href="#P':72"><span class="id" title="binder">P'</span></a> <a id="Q:73" class="idref" href="#Q:73"><span class="id" title="binder">Q</span></a> <a id="Q':74" class="idref" href="#Q':74"><span class="id" title="binder">Q'</span></a> : <a class="idref" href="Hoare.html#Assertion"><span class="id" title="definition">Assertion</span></a>) <a id="c:75" class="idref" href="#c:75"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P':72"><span class="id" title="variable">P'</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#c:75"><span class="id" title="variable">c</span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q':74"><span class="id" title="variable">Q'</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#P:71"><span class="id" title="variable">P</span></a> <a class="idref" href="Hoare.html#::hoare_spec_scope:x_'-&gt;&gt;'_x"><span class="id" title="notation"><span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span><span style='letter-spacing:-.2em;'>></span>></span></span></span></a> <a class="idref" href="Hoare3.html#P':72"><span class="id" title="variable">P'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#Q':74"><span class="id" title="variable">Q'</span></a> <a class="idref" href="Hoare.html#::hoare_spec_scope:x_'-&gt;&gt;'_x"><span class="id" title="notation"><span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span><span style='letter-spacing:-.2em;'>></span>></span></span></span></a> <a class="idref" href="Hoare3.html#Q:73"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:71"><span class="id" title="variable">P</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#c:75"><span class="id" title="variable">c</span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q:73"><span class="id" title="variable">Q</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a>.<br/>
<div class="togglescript" id="proofcontrol11" onclick="toggleDisplay('proof11');toggleDisplay('proofcontrol11')"><span class="show"></span></div>
<div class="proofscript" id="proof11" onclick="toggleDisplay('proof11');toggleDisplay('proofcontrol11')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">P'</span> <span class="id" title="var">Q</span> <span class="id" title="var">Q'</span> <span class="id" title="var">c</span> <span class="id" title="var">Htriple</span> <span class="id" title="var">Hpre</span> <span class="id" title="var">Hpost</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Hoare3.html#hoare_itree_consequence_pre"><span class="id" title="lemma">hoare_itree_consequence_pre</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">P'</span> := <span class="id" title="var">P'</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="Hoare3.html#hoare_itree_consequence_post"><span class="id" title="lemma">hoare_itree_consequence_post</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">Q'</span> := <span class="id" title="var">Q'</span>); <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
<a id="lab255"></a><h3 class="section">Vacuous assertions</h3>

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a id="hoare_itree_post_true" class="idref" href="#hoare_itree_post_true"><span class="id" title="lemma">hoare_itree_post_true</span></a> : <span class="id" title="keyword">∀</span> (<a id="P:76" class="idref" href="#P:76"><span class="id" title="binder">P</span></a> <a id="Q:77" class="idref" href="#Q:77"><span class="id" title="binder">Q</span></a> : <a class="idref" href="Hoare.html#Assertion"><span class="id" title="definition">Assertion</span></a>) <a id="c:78" class="idref" href="#c:78"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="st:79" class="idref" href="#st:79"><span class="id" title="binder">st</span></a>, <a class="idref" href="Hoare3.html#Q:77"><span class="id" title="variable">Q</span></a> <a class="idref" href="Hoare3.html#st:79"><span class="id" title="variable">st</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:76"><span class="id" title="variable">P</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#c:78"><span class="id" title="variable">c</span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q:77"><span class="id" title="variable">Q</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a>.<br/>
<div class="togglescript" id="proofcontrol12" onclick="toggleDisplay('proof12');toggleDisplay('proofcontrol12')"><span class="show"></span></div>
<div class="proofscript" id="proof12" onclick="toggleDisplay('proof12');toggleDisplay('proofcontrol12')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">c</span> <span class="id" title="var">HQ</span>. <span class="id" title="var">revert</span> <span class="id" title="var">P</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">P</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="Hoare3.html#hoare_itree_consequence_post"><span class="id" title="lemma">hoare_itree_consequence_post</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="Hoare3.html#hoare_itree_skip"><span class="id" title="lemma">hoare_itree_skip</span></a>. <span class="id" title="tactic">red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">HQ</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">P</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Hoare3.html#hoare_itree_triple"><span class="id" title="definition">hoare_itree_triple</span></a>. <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">norm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">eutt_Ret</span>. <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">P</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Hoare3.html#hoare_itree_seq"><span class="id" title="lemma">hoare_itree_seq</span></a>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHc2</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHc1</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">P</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Hoare3.html#hoare_itree_if"><span class="id" title="lemma">hoare_itree_if</span></a>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHc1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHc2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">P</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Hoare3.html#hoare_itree_consequence_pre"><span class="id" title="lemma">hoare_itree_consequence_pre</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">P'</span> := <span class="id" title="var">Q</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Hoare3.html#hoare_itree_consequence_post"><span class="id" title="lemma">hoare_itree_consequence_post</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Hoare3.html#hoare_itree_while"><span class="id" title="lemma">hoare_itree_while</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
Prove that if <span class="inlinecode"><span class="id" title="var">P</span></span> holds in no state, then any triple with <span class="inlinecode"><span class="id" title="var">P</span></span> as
    its precondition is valid. 
</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a id="hoare_itree_pre_false" class="idref" href="#hoare_itree_pre_false"><span class="id" title="lemma">hoare_itree_pre_false</span></a> : <span class="id" title="keyword">∀</span> (<a id="P:80" class="idref" href="#P:80"><span class="id" title="binder">P</span></a> <a id="Q:81" class="idref" href="#Q:81"><span class="id" title="binder">Q</span></a> : <a class="idref" href="Hoare.html#Assertion"><span class="id" title="definition">Assertion</span></a>) <a id="c:82" class="idref" href="#c:82"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="st:83" class="idref" href="#st:83"><span class="id" title="binder">st</span></a>, <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">(</span></a><a class="idref" href="Hoare3.html#P:80"><span class="id" title="variable">P</span></a> <a class="idref" href="Hoare3.html#st:83"><span class="id" title="variable">st</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:80"><span class="id" title="variable">P</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#c:82"><span class="id" title="variable">c</span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q:81"><span class="id" title="variable">Q</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a>.<br/>
<div class="togglescript" id="proofcontrol13" onclick="toggleDisplay('proof13');toggleDisplay('proofcontrol13')"><span class="show"></span></div>
<div class="proofscript" id="proof13" onclick="toggleDisplay('proof13');toggleDisplay('proofcontrol13')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">c</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Hoare3.html#hoare_itree_triple"><span class="id" title="definition">hoare_itree_triple</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">st</span> <span class="id" title="var">HP</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#not"><span class="id" title="definition">not</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span> <span class="id" title="keyword">in</span> <span class="id" title="var">HP</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contradiction</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
<a id="lab256"></a><h3 class="section">Hoare logic respects the semantics</h3>

</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="semantic_preservation" class="idref" href="#semantic_preservation"><span class="id" title="lemma">semantic_preservation</span></a> : <span class="id" title="keyword">∀</span> (<a id="P:84" class="idref" href="#P:84"><span class="id" title="binder">P</span></a> <a id="Q:85" class="idref" href="#Q:85"><span class="id" title="binder">Q</span></a> : <a class="idref" href="Hoare.html#Assertion"><span class="id" title="definition">Assertion</span></a>) (<a id="c<sub>1</sub>:86" class="idref" href="#c<sub>1</sub>:86"><span class="id" title="binder">c<sub>1</sub></span></a> <a id="c<sub>2</sub>:87" class="idref" href="#c<sub>2</sub>:87"><span class="id" title="binder">c<sub>2</sub></span></a> : <a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="481f8487e3a3a0d5bb887248fb3107c<sub>3</sub>" class="idref" href="#481f8487e3a3a0d5bb887248fb3107c<sub>3</sub>"><span class="id" title="binder">σ</span></a>, <a class="idref" href="Hoare3.html#P:84"><span class="id" title="variable">P</span></a> <a class="idref" href="Hoare3.html#481f8487e3a3a0d5bb887248fb3107c<sub>3</sub>"><span class="id" title="variable">σ</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="ImpDenotation.html#7e366676838614efda76d1a99485c90a"><span class="id" title="notation">ℑ</span></a><a class="idref" href="ImpDenotation.html#7e366676838614efda76d1a99485c90a"><span class="id" title="notation">⟦</span></a><a class="idref" href="ImpDenotation.html#7e366676838614efda76d1a99485c90a"><span class="id" title="notation">c<sub>1</sub></span></a><a class="idref" href="ImpDenotation.html#7e366676838614efda76d1a99485c90a"><span class="id" title="notation">⟧σ</span></a> <span class="id" title="notation">≈</span> <a class="idref" href="ImpDenotation.html#7e366676838614efda76d1a99485c90a"><span class="id" title="notation">ℑ</span></a><a class="idref" href="ImpDenotation.html#7e366676838614efda76d1a99485c90a"><span class="id" title="notation">⟦</span></a><a class="idref" href="ImpDenotation.html#7e366676838614efda76d1a99485c90a"><span class="id" title="notation">c<sub>2</sub></span></a><a class="idref" href="ImpDenotation.html#7e366676838614efda76d1a99485c90a"><span class="id" title="notation">⟧σ</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:84"><span class="id" title="variable">P</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#c<sub>1</sub>:86"><span class="id" title="variable">c<sub>1</sub></span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q:85"><span class="id" title="variable">Q</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#P:84"><span class="id" title="variable">P</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a> <a class="idref" href="Hoare3.html#c<sub>2</sub>:87"><span class="id" title="variable">c<sub>2</sub></span></a> <a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Hoare3.html#Q:85"><span class="id" title="variable">Q</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a>.<br/>
<div class="togglescript" id="proofcontrol14" onclick="toggleDisplay('proof14');toggleDisplay('proofcontrol14')"><span class="show"></span></div>
<div class="proofscript" id="proof14" onclick="toggleDisplay('proof14');toggleDisplay('proofcontrol14')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">c<sub>1</sub></span> <span class="id" title="var">c<sub>2</sub></span> <span class="id" title="var">EQ</span> <span class="id" title="var">HC<sub>1</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Hoare3.html#hoare_itree_triple"><span class="id" title="definition">hoare_itree_triple</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">HC<sub>1</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> σ <span class="id" title="var">HS</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">EQ</span> σ <span class="id" title="var">HS</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">EQ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">HC<sub>1</sub></span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
<a id="lab257"></a><h3 class="section">An Example</h3>

</div>
<div class="code">
<span class="id" title="keyword">Example</span> <a id="hoare_itree_if_example" class="idref" href="#hoare_itree_if_example"><span class="id" title="definition">hoare_itree_if_example</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#9e5b22caf5d7cf490e97976162618c2a"><span class="id" title="notation">=</span></a> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a> <a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> 2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a> <a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#ad27fd091d9c8494ce7e5135135d19a<sub>8</sub>"><span class="id" title="notation">+</span></a> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦃</span></a><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Hoare.html#154e85acf24eb57aa8f8a0156c0ba632"><span class="id" title="notation">≤</span></a> <a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a><a class="idref" href="Hoare3.html#d14d6a94ef424fa020b7dfc61d76d9ee"><span class="id" title="notation">⦄</span></a>.<br/>
<div class="togglescript" id="proofcontrol15" onclick="toggleDisplay('proof15');toggleDisplay('proofcontrol15')"><span class="show"></span></div>
<div class="proofscript" id="proof15" onclick="toggleDisplay('proof15');toggleDisplay('proofcontrol15')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Hoare3.html#hoare_itree_if"><span class="id" title="lemma">hoare_itree_if</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="Hoare3.html#hoare_itree_consequence_pre"><span class="id" title="lemma">hoare_itree_consequence_pre</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="Hoare3.html#hoare_itree_asgn"><span class="id" title="lemma">hoare_itree_asgn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">assertion_auto'</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="Hoare3.html#hoare_itree_consequence_pre"><span class="id" title="lemma">hoare_itree_consequence_pre</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="Hoare3.html#hoare_itree_asgn"><span class="id" title="lemma">hoare_itree_asgn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">assertion_auto'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<br/>
<span class="comment">(*&nbsp;2024-06-13&nbsp;11:26&nbsp;*)</span><br/>
</div>
</div>

<div id="footer">
<hr/><a href="coqindex.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>